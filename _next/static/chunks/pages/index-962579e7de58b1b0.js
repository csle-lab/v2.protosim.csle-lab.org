(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{9758:function(e,n,t){"use strict";e.exports=t(9512)},9512:function(e,n,t){"use strict";var o=t(3454),r=function(e){if(e=e||{},this.Promise=e.Promise||Promise,this.queues=Object.create(null),this.domainReentrant=e.domainReentrant||!1,this.domainReentrant){if(void 0===o||void 0===o.domain)throw Error("Domain-reentrant locks require `process.domain` to exist. Please flip `opts.domainReentrant = false`, use a NodeJS version that still implements Domain, or install a browser polyfill.");this.domains=Object.create(null)}this.timeout=e.timeout||r.DEFAULT_TIMEOUT,this.maxOccupationTime=e.maxOccupationTime||r.DEFAULT_MAX_OCCUPATION_TIME,this.maxExecutionTime=e.maxExecutionTime||r.DEFAULT_MAX_EXECUTION_TIME,e.maxPending===1/0||Number.isInteger(e.maxPending)&&e.maxPending>=0?this.maxPending=e.maxPending:this.maxPending=r.DEFAULT_MAX_PENDING};r.DEFAULT_TIMEOUT=0,r.DEFAULT_MAX_OCCUPATION_TIME=0,r.DEFAULT_MAX_EXECUTION_TIME=0,r.DEFAULT_MAX_PENDING=1e3,r.prototype.acquire=function(e,n,t,r){if(Array.isArray(e))return this._acquireBatch(e,n,t,r);if("function"!=typeof n)throw Error("You must pass a function to execute");var i=null,a=null,c=null;"function"!=typeof t&&(r=t,t=null,c=new this.Promise(function(e,n){i=e,a=n})),r=r||{};var s=!1,u=null,d=null,l=null,m=this,p=function(n,o,r){d&&(clearTimeout(d),d=null),l&&(clearTimeout(l),l=null),n&&(m.queues[e]&&0===m.queues[e].length&&delete m.queues[e],m.domainReentrant&&delete m.domains[e]),s||(c?o?a(o):i(r):"function"==typeof t&&t(o,r),s=!0),n&&m.queues[e]&&m.queues[e].length>0&&m.queues[e].shift()()},h=function(t){if(s)return p(t);u&&(clearTimeout(u),u=null),m.domainReentrant&&t&&(m.domains[e]=o.domain);var i=r.maxExecutionTime||m.maxExecutionTime;if(i&&(l=setTimeout(function(){m.queues[e]&&p(t,Error("Maximum execution time is exceeded "+e))},i)),1===n.length){var a=!1;try{n(function(e,n){a||(a=!0,p(t,e,n))})}catch(e){a||(a=!0,p(t,e))}}else m._promiseTry(function(){return n()}).then(function(e){p(t,void 0,e)},function(e){p(t,e)})};if(m.domainReentrant&&o.domain&&(h=o.domain.bind(h)),m.queues[e]){if(m.domainReentrant&&o.domain&&o.domain===m.domains[e])h(!1);else if(m.queues[e].length>=m.maxPending)p(!1,Error("Too many pending tasks in queue "+e));else{var f=function(){h(!0)};r.skipQueue?m.queues[e].unshift(f):m.queues[e].push(f);var g=r.timeout||m.timeout;g&&(u=setTimeout(function(){u=null,p(!1,Error("async-lock timed out in queue "+e))},g))}}else m.queues[e]=[],h(!0);var y=r.maxOccupationTime||m.maxOccupationTime;if(y&&(d=setTimeout(function(){m.queues[e]&&p(!1,Error("Maximum occupation time is exceeded in queue "+e))},y)),c)return c},r.prototype._acquireBatch=function(e,n,t,o){"function"!=typeof t&&(o=t,t=null);var r=this,i=e.reduceRight(function(e,n){return function(t){r.acquire(n,e,t,o)}},n);if("function"!=typeof t)return new this.Promise(function(e,n){1===i.length?i(function(t,o){t?n(t):e(o)}):e(i())});i(t)},r.prototype.isBusy=function(e){return e?!!this.queues[e]:Object.keys(this.queues).length>0},r.prototype._promiseTry=function(e){try{return this.Promise.resolve(e())}catch(e){return this.Promise.reject(e)}},e.exports=r},3454:function(e,n,t){"use strict";var o,r;e.exports=(null==(o=t.g.process)?void 0:o.env)&&"object"==typeof(null==(r=t.g.process)?void 0:r.env)?t.g.process:t(7663)},8312:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(6209)}])},8358:function(e,n,t){"use strict";t.d(n,{SE:function(){return u},ST:function(){return m},Yy:function(){return d},Zl:function(){return l}});var o=t(7294),r=t(9596),i=t(3029),a=t(4255);let c=e=>{var n,t,o;switch(e.type){case"enterAddressBar":return{message:"アドレスバーで ".concat(e.url," にアクセスした"),body:{url:e.url,valid:e.valid}};case"insertManually":return{message:"".concat("smartphone"===e.device?"スマートフォン":"Web サーバ","の").concat(r.KW[e.protocolIndex],"にデータを流し込んだ: ").concat(e.body),body:{device:e.device,protocolIndex:e.protocolIndex,body:e.body}};case"moveCover":return{message:"フタを".concat(e.isCoverOpen?"開けた":"閉じた"),body:{isCoverOpen:e.isCoverOpen}};case"toggleServer":return{message:"Webサーバのディスプレイを".concat(e.isServerOpen?"点けた":"消した"),body:{}};case"setExplorerPath":return{message:"Webサーバのディスプレイで ".concat(e.path," を開いた"),body:{path:e.path,prevPath:e.prevPath,direction:e.direction}};case"switchRouterArea":return{message:"ルータエリアを ".concat(e.isRouterAreaOpen?"開いた":"閉じた"),body:{isRouterAreaOpen:e.isRouterAreaOpen}};case"hoverRouter":return{message:"".concat(e.ipAddress," のルーターにマウスを").concat("enter"===e.direction?"乗せた":"外した (".concat(Math.round(null!==(n=e.duration)&&void 0!==n?n:-1),"ミリ秒)")),body:{ipAddress:e.ipAddress,direction:e.direction,duration:e.duration}};case"copyRouterIpAddress":return{message:"".concat(e.ipAddress," のルーターから「").concat(e.copiedIpAddress,"」をコピーした"),body:{ipAddress:e.ipAddress,copiedIpAddress:e.copiedIpAddress}};case"openProtocol":return{message:"".concat("smartphone"===e.device?"スマートフォン":"Web サーバ","の").concat(r.KW[e.protocolIndex],"の設定画面を開いた"),body:{device:e.device,protocolIndex:e.protocolIndex}};case"changeProtocol":return{message:"".concat("smartphone"===e.device?"スマートフォン":"Web サーバ","の").concat(r.KW[e.protocolIndex],"のプロトコルを").concat(e.protocol.nameJa,"に変更した"),body:{device:e.device,protocolIndex:e.protocolIndex,protocolName:e.protocol.nameJa}};case"openDataPage":return{message:"".concat("smartphone"===e.device?"スマートフォン":"Web サーバ","で").concat("downToUp"===e.direction?"上":"下","向きの").concat(r.KW[e.protocolIndex],"に流れた情報を観察した"),body:{device:e.device,direction:e.direction,protocolIndex:e.protocolIndex}};case"openPreference":return{message:"設定画面を開いた",body:{}};case"setPacketLoss":return{message:"パケットロス設定を".concat(0===e.packetLoss?"発生無しにした":"発生させるようにした"),body:{packetLoss:e.packetLoss}};case"setProcessSpeed":return{message:"データが流れるスピードを ".concat(e.processSpeed," 段階目に変更した"),body:{processSpeed:e.processSpeed}};case"closeSideArea":return{message:"サイドエリアを閉じた",body:{}};case"hoverTerminology":return{message:"専門用語「".concat(e.text,"」にマウスを").concat("enter"===e.direction?"乗せた":"外した (".concat(Math.round(null!==(t=e.duration)&&void 0!==t?t:-1),"ミリ秒)")),body:{text:e.text,direction:e.direction,duration:e.duration}};case"hoverPosition":return{message:"場所を表す言葉「".concat(e.text,"」にマウスを").concat("enter"===e.direction?"乗せた":"外した (".concat(Math.round(null!==(o=e.duration)&&void 0!==o?o:-1),"ミリ秒)")),body:{position:e.position,text:e.text,direction:e.direction,duration:e.duration}};case"submitTextboxes":return{message:"".concat(e.missionId," のミッションのテキストボックスに ").concat(JSON.stringify(e.values)," と入力された状態で決定ボタンを押した"),body:{missionId:e.missionId,values:e.values}};case"showHint":return{message:"".concat(e.missionId," のミッションの ").concat(e.numVisibleHints," 番目のヒントを表示した"),body:{missionId:e.missionId,numVisibleHints:e.numVisibleHints}}}},s=e=>{switch(e.type){case"achieveMission":return{message:"ミッション ".concat(e.missionId," を達成した (ヒントの数：").concat(e.numHints,")"),body:{missionId:e.missionId,numHints:e.numHints}};case"completePage":return{message:"ページ ".concat(e.pageId," を達成した"),body:{pageId:e.pageId}}}},u=async e=>{let n={type:e.type,href:window.location.href,origin:window.location.origin,pathname:window.location.pathname,screen:{width:screen.width,height:screen.height},window:{width:window.innerWidth,height:window.innerHeight},language:await (0,i.G3)(),...c(e)};return await (0,a.uz)("/send_action_log",n)},d=async e=>{let n={type:e.type,href:window.location.href,origin:window.location.origin,pathname:window.location.pathname,screen:{width:screen.width,height:screen.height},window:{width:window.innerWidth,height:window.innerHeight},language:await (0,i.G3)(),...s(e)};return await (0,a.uz)("/send_action_log",n)},l=async e=>{let n={type:e.type,href:window.location.href,origin:window.location.origin,pathname:window.location.pathname,screen:{width:screen.width,height:screen.height},window:{width:window.innerWidth,height:window.innerHeight},language:await (0,i.G3)()};return await (0,a.uz)("/send_action_log",n)},m=()=>{(0,o.useEffect)(()=>{(async()=>{l({type:"view"})})()},[]),(0,o.useEffect)(()=>{setInterval(async()=>{l({type:"keep"})},1e4)},[])}},9211:function(e,n,t){"use strict";let o;t.d(n,{FW:function(){return u},Pc:function(){return g},bQ:function(){return w},jl:function(){return p},kS:function(){return y}});var r=t(9758),i=t.n(r),a=t(7294),c=t(4255);let s=new(i()),u={None:"None",LTI:"LTI"},d=new Date("2000/1/1"),l=async()=>{o=await (0,c.LK)("/get_user"),d=new Date},m=async()=>(await s.acquire("getUserInfo",async()=>{new Date().getTime()-d.getTime()>864e5&&await l()}),o),p=async()=>h(await m())!=u.None,h=e=>null==e?u.None:null!=e.ltiUserInfo?u.LTI:u.None,f=e=>null==e?"":null!=e.ltiUserInfo?e.ltiUserInfo.displayName:"",g=()=>{let[e,n]=(0,a.useState)(void 0);(0,a.useEffect)(()=>{(async()=>{n(await m())})()},[]);let t=async()=>{await l(),n(await m())},o=h(e),r=f(e);return{userInfo:e,userType:o,displayName:r,reloadUserInfo:t}},y=async()=>{await (0,c.uz)("/logout",{})},w=async()=>{await (0,c.uz)("/set_lti",{})}},4255:function(e,n,t){"use strict";t.d(n,{LK:function(){return i},uz:function(){return r}});let o="https://v2-backend.protosim.csle-lab.org",r=async(e,n)=>{try{return await fetch(o+e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),credentials:"include"}).then(e=>{})}catch(e){return}},i=async e=>{try{return await fetch(o+e,{method:"GET",credentials:"include"}).then(e=>{if(e.ok)return e.json()}).catch(()=>{})}catch(e){return}}},3029:function(e,n,t){"use strict";t.d(n,{G3:function(){return i},Jr:function(){return c},QU:function(){return u},XX:function(){return s},m0:function(){return a}});var o=t(7294);let r="PROTOSIM_LOCALIZE_",i=async()=>{let e=localStorage.getItem(r+"language");return null==e?"ja"===window.navigator.language?"ja":"en":e},a=async e=>{localStorage.setItem(r+"language",e)},c=()=>{let[e,n]=(0,o.useState)(null);return(0,o.useEffect)(()=>{(async()=>{n(await i())})()},[]),e},s=(e,n)=>{let t=c();return"ja"===t?e:"en"===t?n:""},u=(e,n,t)=>"ja"===e?n:"en"===e?t:""},9596:function(e,n,t){"use strict";t.d(n,{BY:function(){return a},KW:function(){return i},dt:function(){return r},vJ:function(){return o}});let o={ApplicationLayer:4,TransportLayer:3,InternetLayer:2,NetworkInterfaceLayer:1},r={4:"ApplicationLayer",3:"TransportLayer",2:"InternetLayer",1:"NetworkInterfaceLayer"},i={4:"アプリケーション層",3:"トランスポート層",2:"インターネット層",1:"ネットワークインタフェース層"},a={4:"Application Layer",3:"Transport Layer",2:"Internet Layer",1:"Network Interface Layer"}},6209:function(e,n,t){"use strict";t.r(n);var o=t(5893),r=t(9008),i=t.n(r),a=t(8358),c=t(9211),s=t(3029),u=t(581),d=t.n(u);n.default=()=>{let e=(0,s.Jr)(),{userType:n,displayName:t,reloadUserInfo:r}=(0,c.Pc)();(0,a.ST)();let u=async()=>{await (0,a.Zl)({type:"logout"}),await (0,c.kS)(),await r()},l="ja"===e?"ProtoSim - 通信プロトコルシミュレータ":"en"===e?"ProtoSim - Communication Protocol Simulator":"ProtoSim";return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i(),{children:(0,o.jsx)("title",{children:l})}),(0,o.jsx)("div",{className:d().home,children:(0,o.jsxs)("main",{className:d().homeInner,children:[(0,o.jsxs)("h1",{children:[(0,s.QU)(e,"通信プロトコルシミュレータ","Communication Protocol Simulator"),(0,o.jsx)("br",{}),"ProtoSim","ja"===e&&(0,o.jsx)("div",{children:"プロトシム"})]}),(0,o.jsxs)("div",{className:d().formArea,children:[n===c.FW.None&&(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:d().formPanel,children:[(0,o.jsx)("div",{className:d().row,children:(0,o.jsx)("a",{className:d().button,href:"./app",children:(0,s.QU)(e,"ゲストユーザとして利用","Use as Guest")})}),!1]})}),n===c.FW.LTI&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:d().formPanel,children:(0,o.jsx)("div",{className:d().row,children:(0,o.jsx)("a",{className:d().button,href:"./app",children:(0,s.QU)(e,"ユーザ ".concat(t," として利用"),"Use as a User: ".concat(t))})})}),(0,o.jsx)("div",{className:d().formPanel,children:(0,o.jsx)("div",{className:d().row,children:(0,o.jsx)("button",{className:d().button,type:"button",onClick:e=>u(),children:(0,s.QU)(e,"ログアウト","Logout")})})})]})]})]})})]})}},581:function(e){e.exports={home:"Top_home__lcaWq",homeInner:"Top_homeInner___OcCe",formArea:"Top_formArea__6VUX_",formPanel:"Top_formPanel__Qf5rH",row:"Top_row__uYtsC",col:"Top_col__IcYgU",button:"Top_button__DDkXm",loginMessage:"Top_loginMessage__zCn9v",fadeUp:"Top_fadeUp__kpYpL",fadeUpAnim:"Top_fadeUpAnim__2N1zS"}},7663:function(e){!function(){var n={229:function(e){var n,t,o,r=e.exports={};function i(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function c(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{t="function"==typeof clearTimeout?clearTimeout:a}catch(e){t=a}}();var s=[],u=!1,d=-1;function l(){u&&o&&(u=!1,o.length?s=o.concat(s):d=-1,s.length&&m())}function m(){if(!u){var e=c(l);u=!0;for(var n=s.length;n;){for(o=s,s=[];++d<n;)o&&o[d].run();d=-1,n=s.length}o=null,u=!1,function(e){if(t===clearTimeout)return clearTimeout(e);if((t===a||!t)&&clearTimeout)return t=clearTimeout,clearTimeout(e);try{t(e)}catch(n){try{return t.call(null,e)}catch(n){return t.call(this,e)}}}(e)}}function p(e,n){this.fun=e,this.array=n}function h(){}r.nextTick=function(e){var n=Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)n[t-1]=arguments[t];s.push(new p(e,n)),1!==s.length||u||c(m)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=h,r.addListener=h,r.once=h,r.off=h,r.removeListener=h,r.removeAllListeners=h,r.emit=h,r.prependListener=h,r.prependOnceListener=h,r.listeners=function(e){return[]},r.binding=function(e){throw Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw Error("process.chdir is not supported")},r.umask=function(){return 0}}},t={};function o(e){var r=t[e];if(void 0!==r)return r.exports;var i=t[e]={exports:{}},a=!0;try{n[e](i,i.exports,o),a=!1}finally{a&&delete t[e]}return i.exports}o.ab="//";var r=o(229);e.exports=r}()},9008:function(e,n,t){e.exports=t(7828)}},function(e){e.O(0,[888,774,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);